p8105_hw5_lx2346
================
linshan
2024-11-02

## Problem 1

### create a function to check whether there is a replicate

``` r
bdays_sim = function(n) {
  bdays = sample(1:365, size = n, replace = TRUE)
  length(unique(bdays)) < n
  duplicate = length(unique(bdays)) < n
  return(duplicate)
}
```

### run this function 10000 times for each group size between 2 and 50

``` r
sim_res = expand_grid(
  n = 2:50,
  iter = 1:10000
) |>
  mutate(res = map_lgl(n, bdays_sim)) |>
  group_by(n) |>
  summarize(prob = mean(res))

sim_res
```

    ## # A tibble: 49 × 2
    ##        n   prob
    ##    <int>  <dbl>
    ##  1     2 0.0024
    ##  2     3 0.0093
    ##  3     4 0.0179
    ##  4     5 0.0299
    ##  5     6 0.0367
    ##  6     7 0.0581
    ##  7     8 0.0717
    ##  8     9 0.0976
    ##  9    10 0.117 
    ## 10    11 0.144 
    ## # ℹ 39 more rows

### Make a plot showing the probability as a function of group size, and comment on your results.

``` r
sim_res |>
  ggplot(aes(x = n, y = prob)) +
  geom_line()
```

<img src="p8105_hw5_lx2346_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />  
**Comment**:As the group size increases, the probability that two people
share the same birthday also increases. When n = 23， the probability
exceeds 0.5.

## Prblem 2

### Generate 5000 datasets from the model 𝑥∼𝑁𝑜𝑟𝑚𝑎𝑙\[𝜇,𝜎\]

``` r
normal_sim = function(miu = 0, sample_size = 30, sigma = 5) {
  sim_data = tibble(x_vec = rnorm(sample_size, miu , sigma))
  
  test_result = t.test(sim_data$x_vec, mu = miu)
  res_clean = broom::tidy(test_result)
  
  out_df = tibble(mu_hat = res_clean$estimate,
                  p_value = res_clean$p.value)
  
  return(out_df)
}
```

``` r
sim_res_2 = 
  tibble(
    iter = 1:5000
  )|>
  mutate(samp_res = map(iter, normal_sim)) |>
  unnest(samp_res)

sim_res_2
```

    ## # A tibble: 5,000 × 3
    ##     iter mu_hat p_value
    ##    <int>  <dbl>   <dbl>
    ##  1     1   2.71 0.0442 
    ##  2     2   4.38 0.00514
    ##  3     3   2.36 0.502  
    ##  4     4   3.83 0.860  
    ##  5     5   5.49 0.619  
    ##  6     6   6.96 0.284  
    ##  7     7   8.91 0.0308 
    ##  8     8   8.61 0.495  
    ##  9     9   9.14 0.881  
    ## 10    10  10.4  0.641  
    ## # ℹ 4,990 more rows

### Repeat the above for 𝜇={1,2,3,4,5,6}

``` r
sim_res_3 = 
  expand_grid(
    n = c(1, 2, 3, 4, 5, 6),
    iter = 1:5000
  )|>
  mutate(samp_res = map(n, \(x) normal_sim(miu = x, sample_size = 30, sigma = 5))) |>
  unnest(samp_res)
```

### Make a plot showing the proportion of times the null was rejected (the power of the test) on the y axis and the true value of 𝜇 on the x axis.

``` r
sim_res_3 |>
  group_by(n) |>
  summarize(power = mean(p_value < 0.05)) |>
  ggplot(aes(x = n, y = power)) +
  geom_line() +
  geom_point() +
  labs(x = "True Value of μ", y = "Power", title = "Power vs. True μ") +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = seq(1, 6, by = 1))
```

<img src="p8105_hw5_lx2346_files/figure-gfm/unnamed-chunk-8-1.png" width="90%" />
